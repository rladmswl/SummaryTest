{"ast":null,"code":"import { createAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\";\nimport { setCookie, getCookie, deleteCookie } from \"../../shared/Cookie\";\nimport { auth } from \"../../shared/firebase\";\nimport firebase from \"firebase/app\"; // actions\n\nconst LOG_OUT = \"LOG_OUT\";\nconst GET_USER = \"GET_USER\";\nconst SET_USER = \"SET_USER\"; // action creators\n\nconst logOut = createAction(LOG_OUT, user => ({\n  user\n}));\nconst getUser = createAction(GET_USER, user => ({\n  user\n}));\nconst setUser = createAction(SET_USER, user => ({\n  user\n})); // initialState\n\nconst initialState = {\n  user: null,\n  is_login: false\n}; // middleware actions\n\nconst loginFB = (id, pwd) => {\n  return function (dispatch, getState, _ref) {\n    let {\n      history\n    } = _ref;\n    auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then(res => {\n      auth.signInWithEmailAndPassword(id, pwd).then(user => {\n        console.log(user);\n        dispatch(setUser({\n          user_name: user.user.displayName,\n          id: id,\n          user_profile: \"\",\n          uid: user.user.uid\n        }));\n        history.push(\"/\");\n      }).catch(error => {\n        var errorCode = error.code;\n        var errorMessage = error.message;\n        console.log(errorCode, errorMessage);\n      });\n    });\n  };\n};\n\nconst signupFB = (id, pwd, user_name) => {\n  return function (dispatch, getState, _ref2) {\n    let {\n      history\n    } = _ref2;\n    auth.createUserWithEmailAndPassword(id, pwd).then(user => {\n      console.log(user);\n      auth.currentUser.updateProfile({\n        displayName: user_name\n      }).then(() => {\n        dispatch(setUser({\n          user_name: user_name,\n          id: id,\n          user_profile: \"\",\n          uid: user.user.uid\n        }));\n        history.push(\"/\");\n      }).catch(error => {\n        console.log(error);\n      }); // Signed in\n      // ...\n    }).catch(error => {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      console.log(errorCode, errorMessage); // ..\n    });\n  };\n};\n\nconst loginCheckFB = () => {\n  return function (dispatch, getState, _ref3) {\n    let {\n      history\n    } = _ref3;\n    auth.onAuthStateChanged(user => {\n      if (user) {\n        dispatch(setUser({\n          user_name: user.displayName,\n          user_profile: \"\",\n          id: user.email,\n          uid: user.uid\n        }));\n      } else {\n        dispatch(logOut());\n      }\n    });\n  };\n};\n\nconst logoutFB = () => {\n  return function (dispatch, getState, _ref4) {\n    let {\n      history\n    } = _ref4;\n    auth.signOut().then(() => {\n      dispatch(logOut());\n      history.replace('/');\n    });\n  };\n}; // reducer\n\n\nexport default handleActions({\n  [SET_USER]: (state, action) => produce(state, draft => {\n    setCookie(\"is_login\", \"success\");\n    draft.user = action.payload.user;\n    draft.is_login = true;\n  }),\n  [LOG_OUT]: (state, action) => produce(state, draft => {\n    deleteCookie(\"is_login\");\n    draft.user = null;\n    draft.is_login = false;\n  }),\n  [GET_USER]: (state, action) => produce(state, draft => {})\n}, initialState); // action creator export\n\nconst actionCreators = {\n  logOut,\n  getUser,\n  signupFB,\n  loginFB,\n  loginCheckFB,\n  logoutFB\n};\nexport { actionCreators };","map":{"version":3,"names":["createAction","handleActions","produce","setCookie","getCookie","deleteCookie","auth","firebase","LOG_OUT","GET_USER","SET_USER","logOut","user","getUser","setUser","initialState","is_login","loginFB","id","pwd","dispatch","getState","history","setPersistence","Auth","Persistence","SESSION","then","res","signInWithEmailAndPassword","console","log","user_name","displayName","user_profile","uid","push","catch","error","errorCode","code","errorMessage","message","signupFB","createUserWithEmailAndPassword","currentUser","updateProfile","loginCheckFB","onAuthStateChanged","email","logoutFB","signOut","replace","state","action","draft","payload","actionCreators"],"sources":["/Users/eunji/Desktop/은지/Test2/test2/src/redux/modules/user.js"],"sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\";\n\nimport { setCookie, getCookie, deleteCookie } from \"../../shared/Cookie\";\n\nimport { auth } from \"../../shared/firebase\";\nimport firebase from \"firebase/app\";\n\n// actions\nconst LOG_OUT = \"LOG_OUT\";\nconst GET_USER = \"GET_USER\";\nconst SET_USER = \"SET_USER\";\n\n// action creators\nconst logOut = createAction(LOG_OUT, (user) => ({ user }));\nconst getUser = createAction(GET_USER, (user) => ({ user }));\nconst setUser = createAction(SET_USER, (user) => ({ user }));\n\n// initialState\nconst initialState = {\n  user: null,\n  is_login: false,\n};\n\n// middleware actions\nconst loginFB = (id, pwd) => {\n  return function (dispatch, getState, { history }) {\n    auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then((res) => {\n      auth\n        .signInWithEmailAndPassword(id, pwd)\n        .then((user) => {\n          console.log(user);\n\n          dispatch(\n            setUser({\n              user_name: user.user.displayName,\n              id: id,\n              user_profile: \"\",\n              uid: user.user.uid,\n            })\n          );\n\n          history.push(\"/\");\n        })\n        .catch((error) => {\n          var errorCode = error.code;\n          var errorMessage = error.message;\n\n          console.log(errorCode, errorMessage);\n        });\n    });\n  };\n};\n\nconst signupFB = (id, pwd, user_name) => {\n  return function (dispatch, getState, { history }) {\n    auth\n      .createUserWithEmailAndPassword(id, pwd)\n      .then((user) => {\n        console.log(user);\n\n        auth.currentUser\n          .updateProfile({\n            displayName: user_name,\n          })\n          .then(() => {\n            dispatch(\n              setUser({\n                user_name: user_name,\n                id: id,\n                user_profile: \"\",\n                uid: user.user.uid,\n              })\n            );\n            history.push(\"/\");\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n\n        // Signed in\n        // ...\n      })\n      .catch((error) => {\n        var errorCode = error.code;\n        var errorMessage = error.message;\n\n        console.log(errorCode, errorMessage);\n        // ..\n      });\n  };\n};\n\nconst loginCheckFB = () => {\n  return function (dispatch, getState, {history}){\n    auth.onAuthStateChanged((user) => {\n      if(user){\n        dispatch(\n          setUser({\n            user_name: user.displayName,\n            user_profile: \"\",\n            id: user.email,\n            uid: user.uid,\n          })\n        );\n      }else{\n        dispatch(logOut());\n      }\n    })\n  }\n}\n\nconst logoutFB = () => {\n  return function (dispatch, getState, {history}) {\n    auth.signOut().then(() => {\n      dispatch(logOut());\n      history.replace('/');\n    })\n  }\n}\n\n// reducer\nexport default handleActions(\n  {\n    [SET_USER]: (state, action) =>\n      produce(state, (draft) => {\n        setCookie(\"is_login\", \"success\");\n        draft.user = action.payload.user;\n        draft.is_login = true;\n      }),\n    [LOG_OUT]: (state, action) =>\n      produce(state, (draft) => {\n        deleteCookie(\"is_login\");\n        draft.user = null;\n        draft.is_login = false;\n      }),\n    [GET_USER]: (state, action) => produce(state, (draft) => {}),\n  },\n  initialState\n);\n\n// action creator export\nconst actionCreators = {\n  logOut,\n  getUser,\n  signupFB,\n  loginFB,\n  loginCheckFB,\n  logoutFB,\n};\n\nexport { actionCreators };"],"mappings":"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"},"metadata":{},"sourceType":"module"}